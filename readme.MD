# üì± WhatsApp API v1 - Baileys

<h1 align="center" style="font-weight: bold;">WhatsApp API v1 üöÄ</h1>

<p align="center">
  <a href="#tech">Tecnologias</a> ‚Ä¢
  <a href="#started">Primeiros passos</a> ‚Ä¢
  <a href="#session-routes">Session Endpoints</a> ‚Ä¢
  <a href="#message-routes">Message Endpoints</a> ‚Ä¢
  <a href="#webhook-routes">Webhook Endpoints</a>
</p>

---

## üíª Tecnologias

- Node.js
- Express
- @whiskeysockets/baileys
- qrcode
- axios

---

## üöÄ Primeiros Passos

### Pr√©-requisitos

- [Node.js](https://nodejs.org/pt)
- [Git](https://git-scm.com/)

### Instala√ß√£o

```bash
npm init -y
npm install express @whiskeysockets/baileys qrcode axios
```

### Iniciar o servidor

```bash
npm run dev
```

---

## üìç Endpoints

| Rota                                  | Descri√ß√£o                                 |
| ------------------------------------- | ----------------------------------------- |
| `POST /session`                       | Iniciar uma nova sess√£o                   |
| `GET /qr/:sessionId`                  | Obter QR code para autentica√ß√£o           |
| `DELETE /session/:sessionId`          | Encerrar uma sess√£o                       |
| `POST /session/:sessionId/refresh-qr` | Gerar novo QR code                        |
| `POST /send`                          | Enviar mensagem                           |
| `POST /set-webhook`                   | Configurar webhook para receber mensagens |

### POST /session

**Request:**

```json
{
  "sessionId": "minha-sessao-123"
}
```

**Response:**

```json
{
  "message": "Sess√£o minha-sessao-123 iniciada. Escaneie o QR code via /qr/minha-sessao-123"
}
```

---

### GET /qr/:sessionId

**Response:**

```json
{
  "qr": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA..."
}
```

---

### DELETE /session/:sessionId

**Response:**

```json
{
  "message": "Sess√£o minha-sessao-123 desconectada com sucesso"
}
```

---

### POST /session/:sessionId/refresh-qr

**Response:**

```json
{
  "message": "Sess√£o minha-sessao-123 reiniciada. Novo QR code gerado."
}
```

---

### POST /send

**Request:**

```json
{
  "sessionId": "minha-sessao-123",
  "to": "5511999999999",
  "message": "Ol√°, isso √© um teste!"
}
```

**Response:**

```json
{
  "success": true,
  "to": "5511999999999",
  "message": "Ol√°, isso √© um teste!"
}
```

### POST /set-webhook

**Request:**

```json
{
  "sessionId": "minha-sessao-123",
  "webhookUrl": "https://meu-webhook.com/receber-mensagens"
}
```

**Response:**

```json
{
  "message": "Webhook definido para sess√£o minha-sessao-123"
}
```

---

### Estrutura do Webhook

Quando configurado, o webhook receber√° mensagens no seguinte formato:

```json
{
  "sessionId": "minha-sessao-123",
  "messageId": "3EB0C1D95A5B8",
  "from": "5521975140550@s.whatsapp.net",
  "fromUser": "5521975140550",
  "name": "Arthur",
  "text": "Ol√°, como vai?",
  "type": "conversation",
  "timestamp": 1634567890
}
```

---

‚ö†Ô∏è **Observa√ß√µes Importantes**

- As sess√µes s√£o armazenadas na pasta `./sessions/`
- Mantenha o `sessionId` consistente para reutilizar a mesma sess√£o
- Mensagens s√≥ ser√£o enviadas/recebidas ap√≥s a sess√£o estar autenticada
